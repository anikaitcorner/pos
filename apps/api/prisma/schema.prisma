generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model User {
  id        String    @id @default(uuid())
  name      String
  username  String    @unique()
  email     String    @unique()
  password  String
  business  Business?
  role      Role      @default(ADMIN)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now())
}

model Business {
  id       String    @id @default(uuid())
  name     String
  location String?
  user     User      @relation(fields: [userId], references: [id])
  userId   String    @unique
  products Product[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  @@index([userId])
}

model Product {
  id           String @id @default(uuid())
  name         String
  price        Float  @default(0)
  unitCost     Float  @default(0)
  sellingPrice Float  @default(dbgenerated("price"))
  quantity     Int    @default(0)
  discount     Int
  unitType     String
  grossProfit  Float
  grossMargin  Float
  sku          String

  busines    Business @relation(fields: [businessId], references: [id])
  businessId String

  status     ProductStatus @default(UNSOLD)
  category   Category      @relation(fields: [categoryId], references: [id])
  categoryId String

  @@index([categoryId])
  @@index([businessId])
}

model Category {
  id      String    @id @default(uuid())
  name    String
  product Product[]
}

model Unit {
  id        String @id @default(uuid())
  name      String
  shortName String
}

enum ProductStatus {
  SOLD
  UNSOLD
  LOST
  RETURNED
}

enum Role {
  ADMIN
  SALES_MAN
  MANAGER
}
